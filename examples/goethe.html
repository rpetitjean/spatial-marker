<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Goethe's Theory of Colors</title>
    <meta name="description" content="An XR experience about Goethe's Theory of Colors using spatial-marker">

    <!-- A-frame 1.7.1 -->
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>

    <!-- Spatial-Marker -->
    <script src="https://rpetitjean.github.io/spatial-marker/spatial-marker.js"></script>

    <!-- A-frame extras necessary for navmesh movement + Ada Rose Cannon simple-navmesh-constraint components + aframe-environment-component used for the sky -->
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AdaRoseCannon/aframe-xr-boilerplate/simple-navmesh-constraint.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.5.x/dist/aframe-environment-component.min.js"></script>
    
    <!-- A-frame components created for the text intro and the music management -->
    <script src="js/aframe-ui.js/intro-overlay.js" ></script>
    <script src="js/aframe-ui.js/background-music-manager.js" ></script>
    
    <!-- A-frame components for the XR laser -->
    <script src="js/xr/laser-beam.js"></script>

    <!-- A-frame components used through the Goethe's Theory of Colors world -->
    <script src="assets/goethe-colors/js/components/area-fade-gradient.js"></script>
    <script src="assets/goethe-colors/js/components/fade-on-event.js"></script>
    <script src="assets/goethe-colors/js/components/shimmer-material.js"></script>
    <script src="assets/goethe-colors/js/components/goethe-zones.js"></script>
    <script src="assets/goethe-colors/js/components/flat-override.js"></script>
    <script src="assets/goethe-colors/js/components/gradient-color.js"></script>

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="github.css">

  </head>

  <body>

  <div id="ui-topright">
    <button id="btn-music" class="ui-circle" aria-label="Toggle music" title="Music">
      <span id="icon-music"></span>
    </button>
  </div>

  <a class="github-fab"
     href="https://github.com/rpetitjean/spatial-marker/blob/main/examples/goethe.html"
     target="_blank"
     rel="noopener noreferrer"
     aria-label="Open source code on GitHub">
    <span class="gh-dot" aria-hidden="true"></span>
    <span class="gh-label">Source</span>
  </a>


<script src="assets/goethe-colors/js/ui/music-ui.js"></script>
<script src="assets/goethe-colors/js/ui/pop-up.js"></script>

<a-scene 
    light="defaultLightsEnabled: false" 
    background="color: #ffffff" 
    renderer="colorManagement: linear; physicallyCorrectLights: true; sortTransparentObjects: true; "
    goethe-zones
    bgm-manager="src: assets/goethe-colors/FranzLiszt_Berceuse_D_FlatMajor_174_ScoreToMIDI_CC0_compressed.mp3;
               volume: 0.75;
               fadeInMs: 900;
               fadeOutMs: 600;
               pauseWhenHidden: true"
  
    intro-overlayy="
    backgroundColor: #ffffff;
    textColor: #000000;
    fontFamily: system-ui;
    fontSize: 1.1rem;
    lang1Code: en;
    lang2Code: fr;
    buttonLabel1: Enter;
    buttonLabel2: Entrer;
    loadingText1: Loading assets…;
    loadingText2: Chargement des éléments…;
    charSpeed: 55;         
    lineGap: 300;         
    imageFadeDuration: 2000;

    text1: a poet, scientist and philosopher came to a long work on colors,<br>
    he studied light, pigments, paintings, psychology...<br>
    <br>
    And he made his 'Color Theory', as a wide set of reflections and ideas.<br>There he drafted a purely 'intuitive' diagram<br> 
    <br> 
    ➔ on a possible meaning of colors<br>;

    text2:un poète, scientifique et philosophe a longuement réfléchi sur les couleurs, <br>
    il a étudié la lumière, les pigments, la peinture, la psychologie… <br>
    <br>
    Et il a écrit sa « Théorie des couleurs », un ensemble vaste d’idées et de réflexions. <br>
    Il y a dessiné un diagramme particulier, une intuition <br> 
    <br> 
    ➔ la signification possible des couleurs.<br>;

    lang1Code: en;
    lang2Code: fr;
    buttonLabel1: Enter;
    buttonLabel2: Entrer;
    loadingText1: Chargement des éléments…;
    loadingText2: Loading assets…;">

  <a-assets>

  <img id="line" src="assets/goethe-colors/Line.png">

    <!-- Environement assets + Navmesh -->
    <a-asset-item id="env" src="assets/goethe-colors/env-goethe.glb"></a-asset-item>
    <a-asset-item id="navmesh" src="assets/goethe-colors/navmesh-env.glb"></a-asset-item>
    <a-asset-item id="table" src="assets/goethe-colors/table.glb"></a-asset-item>
    <img id="diagram" src="assets/goethe-colors/upscale-diagram_png512.png">
    <a-asset-item id="goethe" src="assets/goethe-colors/goethe.glb"></a-asset-item>

    <!-- 3 hand written UI for informations -->
    <a-asset-item id="theory-of-color-info" src="assets/goethe-colors/theoryofcolors.glb"></a-asset-item>
    <a-asset-item id="diagram-info" src="assets/goethe-colors/colordiagram.glb"></a-asset-item>
    <a-asset-item id="JW-Goetheinfo" src="assets/goethe-colors/goethe-written.glb"></a-asset-item>

    <!-- hand-written information texts -->
    <a-asset-item id="text1" src="assets/goethe-colors/texts-maker/text-JWGoether.glb"></a-asset-item>
    <a-asset-item id="text2" src="assets/goethe-colors/texts-maker/text-diagram.glb"></a-asset-item>
    <a-asset-item id="text3" src="assets/goethe-colors/texts-maker/text-theory.glb"></a-asset-item>

    <!-- 6 .drawingArea navmeshes for the spatial-marker -->
    <a-asset-item id="navmesh-blue" src="assets/goethe-colors/navmesh-blue.glb"></a-asset-item>
    <a-asset-item id="navmesh-green" src="assets/goethe-colors/navmesh-green.glb"></a-asset-item>
    <a-asset-item id="navmesh-indigo" src="assets/goethe-colors/navmesh-indigo.glb"></a-asset-item>
    <a-asset-item id="navmesh-orange" src="assets/goethe-colors/navmesh-orange.glb"></a-asset-item>
    <a-asset-item id="navmesh-red" src="assets/goethe-colors/navmesh-red.glb"></a-asset-item>
    <a-asset-item id="navmesh-yellow" src="assets/goethe-colors/navmesh-yellow.glb"></a-asset-item>

    <!-- 3D Framed used accross experience from CC0 asset by the Cleveland Museum of Art 
    (https://sketchfab.com/3d-models/195821-mount-sainte-victoire-10d9d7aa5dac45b899b1cf5ba00a5e2b) -->
    <a-asset-item id="element-frame" src="assets/goethe-colors/frame-env.glb"></a-asset-item>

    <!-- A-frame components used through the Goethe's Theory of Colors world -->
    <a-asset-item id="edel" src="assets/goethe-colors/words compressed/Edel.glb"></a-asset-item>
    <a-asset-item id="gemein" src="assets/goethe-colors/words compressed/Gemein.glb"></a-asset-item>
    <a-asset-item id="gut" src="assets/goethe-colors/words compressed/Gut.glb"></a-asset-item>
    <a-asset-item id="nuztlich" src="assets/goethe-colors/words compressed/Nuztlich.glb"></a-asset-item>
    <a-asset-item id="phantasie" src="assets/goethe-colors/words compressed/phantasie.glb"></a-asset-item>
    <a-asset-item id="schon" src="assets/goethe-colors/words compressed/Schon.glb"></a-asset-item>
    <a-asset-item id="verstand" src="assets/goethe-colors/words compressed/Verstand.glb"></a-asset-item>
    <a-asset-item id="sinnlichkeit" src="assets/goethe-colors/words compressed/sinnlichkeit.glb"></a-asset-item>
    <a-asset-item id="unnothig" src="assets/goethe-colors/words compressed/unnothig.glb"></a-asset-item>
    <a-asset-item id="vernunft" src="assets/goethe-colors/words compressed/Vernunft.glb"></a-asset-item>

    <!-- Franz Liszt - Berceuse in D-flat major - CC0 from MIDI file created from Public Domain score, created using a CC0 piano by Versilian Studios (https://versilian-studios.com/vcsl-keys/)-->
    <audio id="bgm" src="assets/goethe-colors/FranzLiszt_Berceuse_D_FlatMajor_174_ScoreToMIDI_CC0_compressed.mp3" preload="auto" loop crossorigin="anonymous"></audio>

  </a-assets>

<!--VR Rig -->
<a-entity id="rig" 
spatial-marker=""
movement-controls="constrainToNavMesh: true ; speed : 0.5; controls: keyboard; enabled:true"  
position="-0.8 0 3.6" rotation="0 -20 0"
simple-navmesh-constraint="navmesh:.navmesh;fall:0;height:0;exclude:.navmesh-hole; "
cursor="rayOrigin: mouse"
raycaster="objects: .clickable">
<a-box camera="far: 700; fov: 55; near: 0.1; active: true" position="0 1.7 0" visible="false" ></a-box>

<a-entity id="left-hand" laser-zone-disable
  laser-controls="hand: left"
  raycaster="objects: .clickable; far: 6; showLine: false"
  cursor="rayOrigin: entity; fuse: false"
  line="opacity: 0; visible: false">

  <!-- Beam that is occluded normally -->
  <a-entity class="beam beam-occluded"
    laser-beam="length: 0.6; radius: 0.0025; mode: occluded; idleColor: #ffffff; hoverColor: #00ff66; fadeSpeed: 22"
    material="shader: flat; src: #line; transparent: true; opacity: 0.95">
  </a-entity>

  <!-- Beam that never disappears (faint) -->
  <a-entity class="beam beam-xray"
    laser-beam="length: 0.6; radius: 0.0025; mode: xray; idleColor: #ffffff; hoverColor: #00ff66; fadeSpeed: 22"
    material="shader: flat; src: #line; transparent: true; opacity: 0.18">
  </a-entity>
</a-entity>

<a-entity id="right-hand" laser-zone-disable
  laser-controls="hand: right"
  raycaster="objects: .clickable; far: 6; showLine: false"
  cursor="rayOrigin: entity; fuse: false"
  line="opacity: 0; visible: false">

  <!-- Beam that is occluded normally -->
  <a-entity class="beam beam-occluded"
    laser-beam="length: 0.6; radius: 0.0025; mode: occluded; idleColor: #ffffff; hoverColor: #00ff66; fadeSpeed: 22"
    material="shader: flat; src: #line; transparent: true; opacity: 0.95">
  </a-entity>

  <!-- Beam that never disappears (faint) -->
  <a-entity class="beam beam-xray"
    laser-beam="length: 0.6; radius: 0.0025; mode: xray; idleColor: #ffffff; hoverColor: #00ff66; fadeSpeed: 22"
    material="shader: flat; src: #line; transparent: true; opacity: 0.18">
  </a-entity>
</a-entity>

</a-entity>

<!-- dot marker for laser interactions with .clickable elements -->
<a-sphere id="debug-marker" radius="0.01" position="0 0 -2" material="color: #ffffff; shader: flat;  opacity: 1; side: double" visible="false"></a-sphere> 

 <!-- Sky -->
<a-sky radius="200" theta-length="110" class="environment" material="shader: skyshader; blending: none; anisotropy: 1.04; turbidity: 20; mieCoefficient: 0.1; mieDirectionalG: 0.72; sunPosition: -0.10389385923870163 0.9444896294427422 0.31168157771610494"></a-sky>
  
<!-- Lights -->
<a-entity light="intensity: 1; type: ambient"></a-entity>
<a-entity light="intensity: 1.884; castShadow: true; shadowBias: -0.0002; shadowCameraFov: 0; shadowCameraNear: -2.47; shadowCameraTop: 8.11; shadowCameraRight: 7.68; shadowCameraBottom: -12.3; shadowCameraLeft: -11.9" position="-0.49743 2.96771 1.19041" data-aframe-default-light="" aframe-injected=""></a-entity>
<a-entity light="intensity: 1.5; type: point" position="0 1.88667 0"></a-entity>

<!-- Scene Environement + nevmesh + shadow hider -->
<a-entity gltf-model="#env" rotation="0 -90 0" position="0 0 0" shadow=""></a-entity>
<a-entity gltf-model="#navmesh" rotation="0 -90 0" position="0 0 0" visible="false" class="navmesh"></a-entity>
<a-entity geometry="primitive: ring; radiusInner: 0.6" rotation="90 -9.55 0" position="0 3.5593 0" scale="6.1595 6.1595 6.1595" shadow="" id="extra-light-hidder"></a-entity>
<a-entity geometry="primitive: ring; radiusInner: 0.6" rotation="90 -9.55 0" position="-0.04525 3.47416 0.02118" scale="3.40291 3.40291 3.40291" shadow="" id="extra-light-hidder-2" material="opacity: 0; side: double; transparent: true"></a-entity>

<!-- Goethe's bust + diagram + table -->  
<a-entity id="goethe-bust" gltf-model="assets/goethe-colors/goethe.glb" rotation="0 -90 0" position="-0.00814 -0.1474 0.01031" shadow="" class="clickable" 
gradient-color="color1: #0841f0; color3: #ff0000; color5: #37005c; color6: #ff4000; colorCount: 4; roughness: 0.7; metalness: 1; speed: 0.7; originalMix: 0.94" 
scale="1.2 1.2 1.2">
</a-entity>

<!-- Diagram plane → diagram text -->
 <a-entity id="diagram-element" material="transparent: true; src: #diagram" geometry="primitive: plane" rotation="-90.00021045914971 62.589336582296 0" position="-0.03296 0.81439 0" shimmer-material="shimmerIntensity: 1.5" class="clickable" fade-on-event="targets: #diagram-text; duration: 3; hold: 5; group: goetheTexts"></a-entity>
<a-entity id="diagram-big" material="opacity: 0.6; transparent: true; src: #diagram" geometry="primitive: plane" rotation="-90.00021045914971 62.589336582296 0" position="-0.03296 0.01241 0" scale="9 9 9">
</a-entity>

<a-entity id="element-Goethe" gltf-model="assets/goethe-colors/goethe-written.glb" position="0.38916 1.39795 0" flat-override="opacity: 0.6" fade-on-event="targets: #goethe-text; duration: 3; hold: 5; group: goetheTexts" class="clickable" scale="0.3 0.3 0.3" rotation="0 -90 0"></a-entity>
<a-entity id="element-theory" gltf-model="assets/goethe-colors/theoryofcolors.glb" position="0.43605 1.18089 0" flat-override="opacity: 0.6" fade-on-event="targets: #diagram-text; duration: 3; hold: 5; group: goetheTexts" class="clickable" scale="0.3 0.3 0.3" rotation="0 -90 0"></a-entity>
<a-entity id="element-diagram" gltf-model="assets/goethe-colors/colordiagram.glb" position="0.45782 0.99437 0" flat-override="opacity: 0.6" fade-on-event="targets: #theory-text; duration: 3; hold: 5; group: goetheTexts" class="clickable" scale="0.3 0.3 0.3" rotation="0 -90 0"></a-entity>
<a-entity gltf-model="#table" rotation="0 -90 0" position="0 0 0" visible="true"></a-entity>

<!-- navmeshs x6 -->
<!-- ORANGE -->
<a-entity id="navmesh-orange-element"
          gltf-model="#navmesh-orange"
          rotation="0 -90 0"
          position="0 0 0"
          class="drawingArea navmesh laser-zone"
          visible="false"
          area-fade-gradient="target: #element-orange-area; zone: orange; maxOpacity: 1; minOpacity: 0.04; speed: 1">
</a-entity>

<!-- BLUE -->
<a-entity id="navmesh-blue-element"
          gltf-model="#navmesh-blue"
          rotation="0 -90 0"
          position="0 0 0"
          class="drawingArea navmesh laser-zone"
          visible="false"
          area-fade-gradient="target: #element-blue-area; zone: blue; maxOpacity: 1; minOpacity: 0.04; speed: 1">
</a-entity>

<!-- RED -->
<a-entity id="navmesh-red-element"
          gltf-model="#navmesh-red"
          rotation="0 -90 0"
          position="0 0 0"
          class="drawingArea navmesh laser-zone"
          visible="false"
          area-fade-gradient="target: #element-red-area; zone: red; maxOpacity: 1; minOpacity: 0.04; speed: 1">
</a-entity>

<!-- YELLOW -->
<a-entity id="navmesh-yellow-element"
          gltf-model="#navmesh-yellow"
          rotation="0 -90 0"
          position="0 0 0"
          class="drawingArea navmesh laser-zone"
          visible="false"
          area-fade-gradient="target: #element-yellow-area; zone: yellow; maxOpacity: 1; minOpacity: 0.04; speed: 1">
</a-entity>

<!-- GREEN -->
<a-entity id="navmesh-green-element"
          gltf-model="#navmesh-green"
          rotation="0 -90 0"
          position="0 0 0"
         class="drawingArea navmesh laser-zone"
          visible="false"
          area-fade-gradient="target: #element-green-area; zone: green; maxOpacity: 1; minOpacity: 0.04; speed: 1">
</a-entity>

<!-- VIOLET / INDIGO -->
<a-entity id="navmesh-indigo-element"
  gltf-model="#navmesh-indigo"
  rotation="0 -90 0"
  position="0 0 0"
  class="drawingArea navmesh laser-zone"
  visible="false">
</a-entity>

<!-- drawing space elements -->
<!-- Orange Area -->
<a-entity id="element-orange-area" 
gltf-model="assets/goethe-colors/frame-env.glb" 
position="0 1.56005 -6.24316" gradient-color="color1: #ffffff; color2: #fff1e5; opacity: 0; roughness: 0; metalness: 1" scale="0.5 0.5 0.5">
</a-entity>

<!-- Blue Area -->
<a-entity id="element-blue-area" 
gltf-model="assets/goethe-colors/frame-env.glb" 
rotation="0 -180 0" position="0 1.47372 6.31276" 
gradient-color="color1: #ffffff; color2: #b6c1cd; opacity: 0; roughness: 0" scale="0.5 0.5 0.5">
</a-entity>

<!-- Red Area -->
<a-entity id="element-red-area" gltf-model="assets/goethe-colors/frame-env.glb" 
rotation="0 62.931965343784235 90.00021045914971" position="-5.36705 1.47327 -2.98325" 
gradient-color="color1: #ffffff; color2: #fff5f5; opacity: 0.1" scale="0.4 0.4 0.4">
</a-entity>

<!-- Yellow Area -->
<a-entity id="element-yellow-area" 
gltf-model="assets/goethe-colors/frame-env.glb" 
rotation="0 -62 -90" position="5.43597 1.52474 -3.13707" 
gradient-color="color1: #ffffff; color2: #eae6d2; opacity: 0; roughness: 0; metalness: 1" scale="0.4 0.4 0.4">
</a-entity>

<!-- Green Area -->
<a-entity id="element-green-area" 
gltf-model="assets/goethe-colors/frame-env.glb" rotation="0 -119.01593912016487 0" 
position="5.44141 1.79871 2.94187" gradient-color="color1: #ffffff; color2: #f0fff0; opacity: 0" scale="0.9 0.9 0.9">
</a-entity>

<!-- Marker-Texts -->
<a-entity id="goethe-text" gltf-model="#text1" position="0.02691 1.816 -1.09926" scale="1.5 1.5 1.5" opacity="0" flat-override="color: #000000"></a-entity>
<a-entity id="diagram-text" gltf-model="#text2" position="0.02691 1.816 -1.09926" scale="1.5 1.5 1.5" opacity="0" flat-override="color: #000000"></a-entity>
<a-entity id="theory-text" gltf-model="#text3" position="0.02691 1.816 -1.09926" scale="1.5 1.5 1.5" opacity="0" flat-override="color: #000000"></a-entity>

<a-entity id="edel" gltf-model="#edel" position="-0.37194 2.28755 -6.13326" flat-override="opacity: 0.52" scale="0.75 0.75 0.75"></a-entity>
<a-entity id="gut" gltf-model="#gut" position="5.49982 2.42192 -3.10054" flat-override="opacity: 0.52" scale="0.75 0.75 0.75" rotation="0 -71.5990979107282 0"></a-entity>
<a-entity id="nuztlich" gltf-model="#nuztlich" position="4.97181 2.28755 2.96997" flat-override="opacity: 0.52" scale="0.75 0.75 0.75" rotation="0 -126.8201972476418 0"></a-entity>
<a-entity id="gemein" gltf-model="#gemein" position="-0.10445 2.28755 6.31301" flat-override="opacity: 0.52" scale="0.75 0.75 0.75" rotation="0 180 0"></a-entity>
<a-entity id="unnothig" gltf-model="#unnothig" position="-5.21878 2.28755 3.2757" flat-override="opacity: 0.52" scale="0.75 0.75 0.75" rotation="0 126.22317522511548 0"></a-entity>
<a-entity id="schon" gltf-model="#schon" position="-5.45174 2.28755 -3.07225" flat-override="opacity: 0.52" scale="0.75 0.75 0.75" rotation="0 60.677376419944444 0"></a-entity>
<a-entity id="verstand" gltf-model="#verstand" position="3.23791 -0.03986 -0.62757" flat-override="opacity: 0.7" rotation="-53.44607608759832 -70.61074571412753 0"></a-entity>
<a-entity id="sinnlichkeit" gltf-model="#sinnlichkeit" position="1.12832 0.17646 2.8613" flat-override="opacity: 0.7" rotation="-52.5980985508047 -158.30422809008053 4.646687718510977"></a-entity>
<a-entity id="phantasie" gltf-model="#phantasie" position="-3.18411 0.25267 0.40501" flat-override="opacity: 0.7" rotation="-70.0079941136499 94.2475465944545 11.106213900815877"></a-entity>
<a-entity id="vernunft" gltf-model="#vernunft" position="-1.32109 0.22329 -2.73259" flat-override="opacity: 0.7" rotation="-65.7698253030672 21.4790418238643 8.341692539309655"></a-entity>

</a-scene>

<!-- Raycast-handlers components - works with the debug marker under the VR rig and sets a small sphere where raycasting is occuring -->
<script src="js/xr/raycast-handler.js"></script>

  </body>
</html>
